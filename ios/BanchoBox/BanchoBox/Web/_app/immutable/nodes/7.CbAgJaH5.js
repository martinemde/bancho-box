import"../chunks/DsnmJJEf.js";import"../chunks/BZzp2Sqo.js";import{p as ce,l as k,s as m,m as b,d as f,g as e,e as le,h as _,i as s,r,j as o,u as c,t as F,b as h,a as ve,a3 as Me,T as Ne,$ as qe,V as ze}from"../chunks/CGMZXle5.js";import{i as z}from"../chunks/Csmq2bM6.js";import{s as te,a as je,b as Q,e as pe,i as Ae,t as ue}from"../chunks/CIiS3sh5.js";import{i as ge}from"../chunks/DKmXlTrh.js";import{p as Ce,a as fe,b as V}from"../chunks/BCPGliUN.js";import{D as U}from"../chunks/CFYNNzyW.js";import{a as x}from"../chunks/Dal0ayJW.js";import{i as Fe,T as Ue,L as Le}from"../chunks/CT3irOJL.js";import{b as oe}from"../chunks/DfpRMjpr.js";const Oe=!0,ct=Object.freeze(Object.defineProperty({__proto__:null,prerender:Oe},Symbol.toStringTag,{value:"Module"}));var Pe=_('<img class="h-full w-full overflow-hidden rounded-md bg-surface-300-700 object-contain" alt="" loading="lazy"/>'),Qe=_("<span> </span>"),Ve=_('<div class="text-sm opacity-70">Not used by any tracked dishes.</div>'),We=_('<tr class="border-b border-surface-200-800"><td class="p-2"> </td><td class="p-2 text-center tabular-nums"> </td><td class="p-2 text-center tabular-nums"> </td></tr>'),Ee=_('<div class="mt-2 overflow-x-auto"><table class="w-full table-auto text-sm"><thead class="bg-surface-200-800"><tr><th class="p-2 text-left">Dish</th><th class="p-2 text-center">Qty</th><th class="p-2 text-center">Upgrade</th></tr></thead><tbody></tbody><tfoot><tr class="bg-surface-200-800 font-semibold"><td class="p-2 text-xs uppercase">Totals</td><td class="p-2 text-center tabular-nums"> </td><td class="p-2 text-center tabular-nums"> </td></tr></tfoot></table></div>'),Ge=_('<article class="divide-y divide-surface-200-800 card border border-surface-200-800 preset-filled-surface-100-900"><section class="p-4"><div class="flex items-start gap-4"><div class="inline-block"><div class="relative"><!></div> <div class="mt-2"><!></div></div> <div class="min-w-0 flex-1 space-y-2"><div class="flex items-center gap-2"><h3 class="m-0 truncate h5 !leading-none"> </h3></div> <div class="mt-1 flex flex-wrap items-center gap-x-3 gap-y-1 opacity-80 *:text-xs"><span> </span></div> <div class="mt-1 flex flex-wrap items-center gap-x-3 gap-y-1 text-sm"><span> </span> <span>Buy: —</span> <!></div></div></div></section> <section class="p-4 pt-0"><!></section></article>');function He(W,L){ce(L,!1);const[j,E]=fe(),D=()=>V(ue,"$trackedDishIds",j),I=()=>V(Q,"$trackedIngredientIds",j),$=b(),l=b(),d=b(),T=b();let a=Ce(L,"ingredient",8);function G(t){return t==null||Number.isNaN(t)?"—":new Intl.NumberFormat().format(Math.round(t))}function A(t){const i=[];for(const u of D()){const g=U.getDishById(u);if(!g)continue;const N=g.ingredients.find(P=>P.ingredientId===t);N&&i.push({dish:g,qty:N.count,upgrade:N.upgradeCount??0})}return i.sort((u,g)=>(g.dish.final_price??0)-(u.dish.final_price??0))}k(()=>f(a()),()=>{m($,Fe(a().name))}),k(()=>f(a()),()=>{m(l,A(a().id))}),k(()=>e(l),()=>{m(d,e(l).reduce((t,i)=>t+i.qty,0))}),k(()=>e(l),()=>{m(T,e(l).reduce((t,i)=>t+i.upgrade,0))}),le(),ge();var w=Ge(),S=s(w),O=s(S),B=s(O);te(B,"width: 96px");var M=s(B);te(M,"width: 96px; height: 96px");var n=s(M);{var v=t=>{var i=Pe();F(()=>je(i,"src",e($))),h(t,i)};z(n,t=>{e($)&&t(v)})}r(M);var y=o(M,2);te(y,"width: 96px");var H=s(y);{var J=t=>{const i=Me(()=>(I(),f(a()),c(()=>I().has(a().id))));Ue(t,{get checked(){return e(i)},$$events:{change:u=>{u.detail.checked?Q.track(a().id):Q.untrack(a().id)}}})};z(H,t=>{f(oe),f(a()),c(()=>oe&&a()?.id!=null)&&t(J)})}r(y),r(B);var p=o(B,2),C=s(p),ae=s(C),me=s(ae,!0);r(ae),r(C);var K=o(C,2),re=s(K),he=s(re,!0);r(re),r(K);var se=o(K,2),R=s(se),_e=s(R);r(R);var xe=o(R,4);{var be=t=>{var i=Qe(),u=s(i);r(i),F(()=>x(u,`Weight: ${f(a()),c(()=>a().kg)??""}kg`)),h(t,i)};z(xe,t=>{f(a()),c(()=>a().kg!=null)&&t(be)})}r(se),r(p),r(O),r(S);var ie=o(S,2),ye=s(ie);{var ke=t=>{var i=Ve();h(t,i)},Ie=t=>{var i=Ee(),u=s(i),g=o(s(u));pe(g,5,()=>e(l),Ae,(De,q)=>{var Y=We(),Z=s(Y),Te=s(Z,!0);r(Z);var ee=o(Z),Se=s(ee,!0);r(ee);var de=o(ee),Be=s(de,!0);r(de),r(Y),F(()=>{x(Te,(e(q),c(()=>e(q).dish.name))),x(Se,(e(q),c(()=>e(q).qty))),x(Be,(e(q),c(()=>e(q).upgrade)))}),h(De,Y)}),r(g);var N=o(g),P=s(N),X=o(s(P)),$e=s(X,!0);r(X);var ne=o(X),we=s(ne,!0);r(ne),r(P),r(N),r(u),r(i),F(()=>{x($e,e(d)),x(we,e(T))}),h(t,i)};z(ye,t=>{e(l),c(()=>e(l).length===0)?t(ke):t(Ie,!1)})}r(ie),r(w),F(t=>{x(me,(f(a()),c(()=>a().name))),x(he,(f(a()),c(()=>a().source))),x(_e,`Sell: ${t??""}`)},[()=>(f(a()),c(()=>a().cost!=null?`${G(a().cost)}g`:"—"))]),h(W,w),ve(),E()}var Je=_('<meta name="description" content="A focused list of tracked ingredients, including those from tracked dishes"/> <meta name="robots" content="noindex"/>',1),Ke=_('<div class="text-sm opacity-70">No tracked ingredients yet. Track an ingredient or a dish to see items here.</div>'),Re=_('<div class="card-list svelte-1p9pte"><!> <!></div>'),Xe=_('<div class="container svelte-1p9pte"><section class="plan"><header class="mb-3"><h1 class="text-xl font-semibold">Tracking</h1> <p class="text-sm opacity-80">Ingredients you tracked directly, plus ingredients required by your tracked dishes.</p></header> <!></section></div>');function lt(W,L){ce(L,!1);const[j,E]=fe(),D=()=>V(ue,"$trackedDishIds",j),I=()=>V(Q,"$trackedIngredientIds",j),$=b(),l=b(),d=b();let T=20,a=b(T);function G(){m(a,Math.min(e(a)+T,e(d).length))}let A=b("");k(()=>(D(),U),()=>{m($,new Set([...D()].flatMap(n=>{const v=U.getDishById(n);return v?v.ingredients.map(y=>y.ingredientId):[]})))}),k(()=>(I(),e($)),()=>{m(l,new Set([...Array.from(I()),...Array.from(e($))]))}),k(()=>(e(l),U),()=>{m(d,Array.from(e(l)).map(n=>U.getIngredientById(n)).filter(n=>!!n))}),k(()=>(I(),D(),e(d),e(A)),()=>{const n=`${I().size}|${D().size}|${e(d).length}`;n!==e(A)&&(m(a,Math.min(T,e(d).length)),m(A,n))}),le(),ge();var w=Xe();Ne(n=>{var v=Je();qe.title="Tracking - Bancho Box",ze(2),h(n,v)});var S=s(w),O=o(s(S),2);{var B=n=>{var v=Ke();h(n,v)},M=n=>{var v=Re(),y=s(v);pe(y,1,()=>(e(d),e(a),c(()=>e(d).slice(0,e(a)))),p=>p.id,(p,C)=>{He(p,{get ingredient(){return e(C)}})});var H=o(y,2);{var J=p=>{Le(p,{rootMargin:"1200px",$$events:{visible:G}})};z(H,p=>{e(a),e(d),c(()=>e(a)<e(d).length)&&p(J)})}r(v),h(n,v)};z(O,n=>{e(d),c(()=>e(d).length===0)?n(B):n(M,!1)})}r(S),r(w),h(W,w),ve(),E()}export{lt as component,ct as universal};
